Cisco IP Phone – Phonebook Directory README
Overview

Cisco IP phones support remote phonebook directories by retrieving an XML file from an HTTP or TFTP server. This file must follow Cisco’s XML schema and be referenced in the phone’s configuration (SEP[MAC].cnf.xml, XMLDefault.cnf.xml, or via the phone’s web UI, depending on the model).

This README explains how to create the XML phonebook file, how to host it, and how to configure Cisco phones to access it.

You will need the following files to create your phonebook:
you can copy the files from the repo here:
contacts.csv -- file where all contacts are stored.
index.php -- web file that you will use to create and edit entries.
cisco-directory.php -- file that you will point your phones to get info from

1.
Start by copying the files to you FreePBX Server
place files in /var/www/html/phonebook

2.
be sure to update the permissions on all the files in the folder so that phones can access
sudo chmod 755 /var/www/html/phonebook/
sudo chown asterisk:asterisk /var/www/html/phonebook/

3.
once you have the files copied and permissions updated test to make sure you can access the index.php from your computer.
this page will allow you to add and remove contacts from your directory
i have also added the ability to sort by either name or number it is your choice.

http://<FreePBX Address>/phonebook/index.php

4.
to add the directory link to the phone you will add the following to the SEP<MAC Address>.cnf.xml

After the </sipProfile> you will find the Phone Services Section

 <phoneServices>
    <provisioning>0</provisioning>
        <phoneService  type="1" category="0">
                <name>Family Directory</name>
        <url>http://<FreePBX Address>/phonebook/cisco-directory.php</url>
        <vendor></vendor>
        <version></version>
    </phoneService>
    <phoneService  type="1" category="0">
        <name>Missed Calls</name>
        <url>Application:Cisco/MissedCalls</url>
        <vendor></vendor>
        <version></version>
        </phoneService>
        <phoneService  type="2" category="0">
                <name>Voicemail</name>
                <url>Application:Cisco/Voicemail</url>
                <vendor></vendor>
                <version></version>
        </phoneService>
        <phoneService  type="1" category="0">
                <name>Received Calls</name>
                <url>Application:Cisco/ReceivedCalls</url>
                <vendor></vendor>
                <version></version>
        </phoneService>
        <phoneService  type="1" category="0">
                <name>Placed Calls</name>
                <url>Application:Cisco/PlacedCalls</url>
                <vendor></vendor>
                <version></version>
        </phoneService>
        </phoneServices>

once you update your .cnf.xml file reboot the phone.

5.Accessing the Directory on the Phone

Once configured:

Press Directories

Choose Corporate Directory

The phone will fetch and display the entries from cisco-directory.php

Selecting a name automatically dials the telephone number

6. Troubleshooting
Symptom: “Host Not Found”

URL or TFTP path is incorrect

File is not readable by TFTP/HTTP server

Wrong protocol (using TFTP when the phone is expecting HTTP)

Symptom: “XML Error”

Invalid XML structure

UTF-8 BOM present

Missing <CiscoIPPhoneDirectory> wrapper

Testing

From any computer:
http://<FreePBX Address>/phonebook/cisco-directory.php



Enjoy!!!